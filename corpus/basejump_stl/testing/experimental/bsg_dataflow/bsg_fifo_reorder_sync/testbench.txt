============================================
basejump_stl/testing/experimental/bsg_dataflow/bsg_fifo_reorder_sync/testbench
============================================

module testbench();

  parameter els_p = 16;
  parameter width_p = 32;
  parameter lg_els_lp = `BSG_SAFE_CLOG2(els_p);
  parameter num_test_p = 100000;

  bit clk;
  bit reset;

  bsg_nonsynth_clock_gen #(
    .cycle_time_p(1000)
  ) cg0 (
    .o(clk)
  );

  bsg_nonsynth_reset_gen #(
    .reset_cycles_lo_p(0)
    ,.reset_cycles_hi_p(8)
  ) rg0 (
    .clk_i(clk)
    ,.async_reset_o(reset)
  );

  logic fifo_alloc_v_lo;
  logic [lg_els_lp-1:0] fifo_alloc_id_lo;
  logic fifo_alloc_yumi_li;

  logic write_v_li;
  logic [lg_els_lp-1:0] write_id_li;
  logic [width_p-1:0] write_data_li;

  logic fifo_deq_v_lo;
  logic [width_p-1:0] fifo_deq_data_lo;
  logic fifo_deq_yumi_li;

  logic empty_lo;

  bsg_fifo_reorder_sync #(
    .width_p(width_p)
    ,.els_p(els_p)
  ) DUT (
    .clk_i(clk)
    ,.reset_i(reset)

    ,.fifo_alloc_v_o(fifo_alloc_v_lo)
    ,.fifo_alloc_id_o(fifo_alloc_id_lo)
    ,.fifo_alloc_yumi_i(fifo_alloc_yumi_li)

    ,.write_v_i(write_v_li)
    ,.write_id_i(write_id_li)
    ,.write_data_i(write_data_li)

    ,.fifo_deq_v_o(fifo_deq_v_lo)
    ,.fifo_deq_data_o(fifo_deq_data_lo)
    ,.fifo_deq_yumi_i(fifo_deq_yumi_li)

    ,.empty_o(empty_lo)
  );


  logic [els_p-1:0] node_v_li;
  logic [width_p-1:0] node_data_li;
  logic [els_p-1:0] node_yumi_lo;

  logic [els_p-1:0] node_v_lo;
  logic [els_p-1:0][width_p-1:0] node_data_lo;
  logic [els_p-1:0] node_yumi_li;

  for (genvar i = 0; i < els_p; i++) begin
    remote_node #(
      .width_p(width_p)
      ,.max_delay_p(32-(i/2)) // unequal random delay
      ,.id_p(i)
    ) node0 (
      .clk_i(clk)
      ,.reset_i(reset)
      
      ,.v_i(node_v_li[i])
      ,.data_i(node_data_li)
      ,.yumi_o(node_yumi_lo[i])

      ,.v_o(node_v_lo[i])
      ,.data_o(node_data_lo[i])
      ,.yumi_i(node_yumi_li[i])
    );
  end


  // sender
  integer sent_r;

  wire send_done = (sent_r == num_test_p);
  
  bsg_decode_with_v #(
    .num_out_p(els_p)
  ) demux0 (
    .i(fifo_alloc_id_lo)
    ,.v_i(fifo_alloc_v_lo & ~send_done)
    ,.o(node_v_li)
  );

  wire send = fifo_alloc_v_lo & node_yumi_lo[fifo_alloc_id_lo] & ~send_done; 
  assign fifo_alloc_yumi_li = send;

  always_ff @ (posedge clk) begin
    if (reset) begin
      sent_r <= 0;
    end
    else begin
      if (send) sent_r <= sent_r + 1;
    end
  end

  assign node_data_li = (width_p)'(sent_r);

  // recv
  logic rr_v_lo;
  logic rr_yumi_li;
  
  bsg_round_robin_n_to_1 #(
    .width_p(width_p)
    ,.num_in_p(els_p)
    ,.strict_p(0)
  ) rr0 (
    .clk_i(clk)
    ,.reset_i(reset)

    ,.data_i(node_data_lo)
    ,.v_i(node_v_lo)
    ,.yumi_o(node_yumi_li)

    ,.v_o(rr_v_lo)
    ,.data_o(write_data_li)
    ,.tag_o(write_id_li)
    ,.yumi_i(rr_yumi_li)
  ); 

  //assign rr_yumi_li = rr_v_lo;
  //assign write_v_li = rr_v_lo;

  integer recv_delay_r;

  always_ff @ (posedge clk) begin
    if (reset) begin
      recv_delay_r <= 0;
    end
    else begin
      if (rr_v_lo) begin
        if (recv_delay_r == 0)
          recv_delay_r <= $urandom_range(8,0);
        else
          recv_delay_r <= recv_delay_r - 1;
      end
    end
  end

  assign rr_yumi_li = rr_v_lo & (recv_delay_r == 0);
  assign write_v_li = rr_v_lo & (recv_delay_r == 0);

  // checker
  integer check_delay_r;

  always_ff @ (posedge clk) begin
    if (reset) begin
      check_delay_r <= 0;
    end
    else begin
      if (fifo_deq_v_lo) begin
        if (check_delay_r == 0) begin
          check_delay_r <= $urandom_range(8,0);
        end
        else begin
          check_delay_r <= check_delay_r - 1;
        end
      end
    end
  end

  assign fifo_deq_yumi_li = fifo_deq_v_lo & (check_delay_r == 0);

  integer check_count_r;
  always_ff @ (posedge clk) begin
    if (reset) begin
      check_count_r <= 0 ;
    end
    else begin
      if (fifo_deq_yumi_li) begin
        check_count_r <= check_count_r + 1;
        $display("data out: %d", fifo_deq_data_lo);
        assert(check_count_r == fifo_deq_data_lo) else $fatal(1, "fail");
      end

    end
  end



  initial begin
    wait((check_count_r == num_test_p) & (sent_r == num_test_p));
    #100000;
    assert(empty_lo) else $fatal(1, "[BSG_FAIL] FIFO is not empty.");
    $finish();
  end
  

endmodule

----

(source_file
  (module_declaration
    (module_nonansi_header
      (module_keyword)
      name: (simple_identifier)
      (list_of_ports))
    (module_item
      (parameter_declaration
        (list_of_param_assignments
          (param_assignment
            (simple_identifier)
            (constant_param_expression
              (constant_mintypmax_expression
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))))
    (module_item
      (parameter_declaration
        (list_of_param_assignments
          (param_assignment
            (simple_identifier)
            (constant_param_expression
              (constant_mintypmax_expression
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))))
    (module_item
      (parameter_declaration
        (list_of_param_assignments
          (param_assignment
            (simple_identifier)
            (constant_param_expression
              (constant_mintypmax_expression
                (constant_expression
                  (text_macro_usage
                    (simple_identifier)
                    (list_of_actual_arguments
                      (actual_argument
                        (param_expression
                          (mintypmax_expression
                            (expression
                              (primary
                                (hierarchical_identifier
                                  (simple_identifier))))))))))))))))
    (module_item
      (parameter_declaration
        (list_of_param_assignments
          (param_assignment
            (simple_identifier)
            (constant_param_expression
              (constant_mintypmax_expression
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (module_instantiation
        instance_type: (simple_identifier)
        (parameter_value_assignment
          (list_of_parameter_value_assignments
            (named_parameter_assignment
              (simple_identifier)
              (param_expression
                (mintypmax_expression
                  (expression
                    (primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))))))
        (hierarchical_instance
          (name_of_instance
            instance_name: (simple_identifier))
          (list_of_port_connections
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))))))
    (module_item
      (module_instantiation
        instance_type: (simple_identifier)
        (parameter_value_assignment
          (list_of_parameter_value_assignments
            (named_parameter_assignment
              (simple_identifier)
              (param_expression
                (mintypmax_expression
                  (expression
                    (primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))))
            (named_parameter_assignment
              (simple_identifier)
              (param_expression
                (mintypmax_expression
                  (expression
                    (primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))))))
        (hierarchical_instance
          (name_of_instance
            instance_name: (simple_identifier))
          (list_of_port_connections
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (module_instantiation
        instance_type: (simple_identifier)
        (parameter_value_assignment
          (list_of_parameter_value_assignments
            (named_parameter_assignment
              (simple_identifier)
              (param_expression
                (mintypmax_expression
                  (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))))
            (named_parameter_assignment
              (simple_identifier)
              (param_expression
                (mintypmax_expression
                  (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))))))
        (hierarchical_instance
          (name_of_instance
            instance_name: (simple_identifier))
          (list_of_port_connections
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)
            (packed_dimension
              (constant_range
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))
                (constant_expression
                  (constant_primary
                    (primary_literal
                      (integral_number
                        (decimal_number
                          (unsigned_number))))))))))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (loop_generate_construct
        (genvar_initialization
          (simple_identifier)
          (constant_expression
            (constant_primary
              (primary_literal
                (integral_number
                  (decimal_number
                    (unsigned_number)))))))
        (constant_expression
          left: (constant_expression
            (constant_primary
              (simple_identifier)))
          right: (constant_expression
            (constant_primary
              (simple_identifier))))
        (genvar_iteration
          (simple_identifier)
          (inc_or_dec_operator))
        (generate_block
          (module_instantiation
            instance_type: (simple_identifier)
            (parameter_value_assignment
              (list_of_parameter_value_assignments
                (named_parameter_assignment
                  (simple_identifier)
                  (param_expression
                    (mintypmax_expression
                      (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))))
                (named_parameter_assignment
                  (simple_identifier)
                  (param_expression
                    (mintypmax_expression
                      (expression
                        left: (expression
                          (primary
                            (primary_literal
                              (integral_number
                                (decimal_number
                                  (unsigned_number))))))
                        right: (expression
                          (primary
                            (mintypmax_expression
                              (expression
                                left: (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier))))
                                right: (expression
                                  (primary
                                    (primary_literal
                                      (integral_number
                                        (decimal_number
                                          (unsigned_number))))))))))))))
                (one_line_comment)
                (named_parameter_assignment
                  (simple_identifier)
                  (param_expression
                    (mintypmax_expression
                      (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))))))
            (hierarchical_instance
              (name_of_instance
                instance_name: (simple_identifier))
              (list_of_port_connections
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier))
                      (select
                        (bit_select
                          (expression
                            (primary
                              (hierarchical_identifier
                                (simple_identifier)))))))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier))
                      (select
                        (bit_select
                          (expression
                            (primary
                              (hierarchical_identifier
                                (simple_identifier)))))))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier))
                      (select
                        (bit_select
                          (expression
                            (primary
                              (hierarchical_identifier
                                (simple_identifier)))))))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier))
                      (select
                        (bit_select
                          (expression
                            (primary
                              (hierarchical_identifier
                                (simple_identifier)))))))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier))
                      (select
                        (bit_select
                          (expression
                            (primary
                              (hierarchical_identifier
                                (simple_identifier)))))))))))))))
    (one_line_comment)
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_atom_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (net_declaration
        (net_type)
        (list_of_net_decl_assignments
          (net_decl_assignment
            (simple_identifier)
            (expression
              (primary
                (mintypmax_expression
                  (expression
                    left: (expression
                      (primary
                        (hierarchical_identifier
                          (simple_identifier))))
                    right: (expression
                      (primary
                        (hierarchical_identifier
                          (simple_identifier))))))))))))
    (module_item
      (module_instantiation
        instance_type: (simple_identifier)
        (parameter_value_assignment
          (list_of_parameter_value_assignments
            (named_parameter_assignment
              (simple_identifier)
              (param_expression
                (mintypmax_expression
                  (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))))))
        (hierarchical_instance
          (name_of_instance
            instance_name: (simple_identifier))
          (list_of_port_connections
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                left: (expression
                  (primary
                    (hierarchical_identifier
                      (simple_identifier))))
                right: (expression
                  operator: (unary_operator)
                  argument: (primary
                    (hierarchical_identifier
                      (simple_identifier))))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))))))
    (module_item
      (net_declaration
        (net_type)
        (list_of_net_decl_assignments
          (net_decl_assignment
            (simple_identifier)
            (expression
              left: (expression
                left: (expression
                  (primary
                    (hierarchical_identifier
                      (simple_identifier))))
                right: (expression
                  (primary
                    (hierarchical_identifier
                      (simple_identifier))
                    (select
                      (bit_select
                        (expression
                          (primary
                            (hierarchical_identifier
                              (simple_identifier)))))))))
              right: (expression
                operator: (unary_operator)
                argument: (primary
                  (hierarchical_identifier
                    (simple_identifier)))))))))
    (module_item
      (continuous_assign
        (list_of_net_assignments
          (net_assignment
            (net_lvalue
              (simple_identifier))
            (expression
              (primary
                (hierarchical_identifier
                  (simple_identifier))))))))
    (module_item
      (always_construct
        (always_keyword)
        (statement
          (statement_item
            (procedural_timing_control_statement
              (event_control
                (clocking_event
                  (event_expression
                    (edge_identifier)
                    (expression
                      (primary
                        (hierarchical_identifier
                          (simple_identifier)))))))
              (statement_or_null
                (statement
                  (statement_item
                    (seq_block
                      (statement_or_null
                        (statement
                          (statement_item
                            (conditional_statement
                              (cond_predicate
                                (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier)))))
                              (statement_or_null
                                (statement
                                  (statement_item
                                    (seq_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (nonblocking_assignment
                                              (variable_lvalue
                                                (hierarchical_identifier
                                                  (simple_identifier)))
                                              (expression
                                                (primary
                                                  (primary_literal
                                                    (integral_number
                                                      (decimal_number
                                                        (unsigned_number))))))))))))))
                              (statement_or_null
                                (statement
                                  (statement_item
                                    (seq_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (conditional_statement
                                              (cond_predicate
                                                (expression
                                                  (primary
                                                    (hierarchical_identifier
                                                      (simple_identifier)))))
                                              (statement_or_null
                                                (statement
                                                  (statement_item
                                                    (nonblocking_assignment
                                                      (variable_lvalue
                                                        (hierarchical_identifier
                                                          (simple_identifier)))
                                                      (expression
                                                        left: (expression
                                                          (primary
                                                            (hierarchical_identifier
                                                              (simple_identifier))))
                                                        right: (expression
                                                          (primary
                                                            (primary_literal
                                                              (integral_number
                                                                (decimal_number
                                                                  (unsigned_number))))))))))))))))))))))))))))))))
    (module_item
      (continuous_assign
        (list_of_net_assignments
          (net_assignment
            (net_lvalue
              (simple_identifier))
            (expression
              (primary
                (cast
                  (casting_type
                    (constant_mintypmax_expression
                      (constant_expression
                        (constant_primary
                          (simple_identifier)))))
                  (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))))))))
    (one_line_comment)
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_vector_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (module_instantiation
        instance_type: (simple_identifier)
        (parameter_value_assignment
          (list_of_parameter_value_assignments
            (named_parameter_assignment
              (simple_identifier)
              (param_expression
                (mintypmax_expression
                  (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))))
            (named_parameter_assignment
              (simple_identifier)
              (param_expression
                (mintypmax_expression
                  (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))))
            (named_parameter_assignment
              (simple_identifier)
              (param_expression
                (mintypmax_expression
                  (expression
                    (primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))))))
        (hierarchical_instance
          (name_of_instance
            instance_name: (simple_identifier))
          (list_of_port_connections
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))
            (named_port_connection
              port_name: (simple_identifier)
              connection: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier)))))))))
    (one_line_comment)
    (one_line_comment)
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_atom_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (always_construct
        (always_keyword)
        (statement
          (statement_item
            (procedural_timing_control_statement
              (event_control
                (clocking_event
                  (event_expression
                    (edge_identifier)
                    (expression
                      (primary
                        (hierarchical_identifier
                          (simple_identifier)))))))
              (statement_or_null
                (statement
                  (statement_item
                    (seq_block
                      (statement_or_null
                        (statement
                          (statement_item
                            (conditional_statement
                              (cond_predicate
                                (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier)))))
                              (statement_or_null
                                (statement
                                  (statement_item
                                    (seq_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (nonblocking_assignment
                                              (variable_lvalue
                                                (hierarchical_identifier
                                                  (simple_identifier)))
                                              (expression
                                                (primary
                                                  (primary_literal
                                                    (integral_number
                                                      (decimal_number
                                                        (unsigned_number))))))))))))))
                              (statement_or_null
                                (statement
                                  (statement_item
                                    (seq_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (conditional_statement
                                              (cond_predicate
                                                (expression
                                                  (primary
                                                    (hierarchical_identifier
                                                      (simple_identifier)))))
                                              (statement_or_null
                                                (statement
                                                  (statement_item
                                                    (seq_block
                                                      (statement_or_null
                                                        (statement
                                                          (statement_item
                                                            (conditional_statement
                                                              (cond_predicate
                                                                (expression
                                                                  left: (expression
                                                                    (primary
                                                                      (hierarchical_identifier
                                                                        (simple_identifier))))
                                                                  right: (expression
                                                                    (primary
                                                                      (primary_literal
                                                                        (integral_number
                                                                          (decimal_number
                                                                            (unsigned_number))))))))
                                                              (statement_or_null
                                                                (statement
                                                                  (statement_item
                                                                    (nonblocking_assignment
                                                                      (variable_lvalue
                                                                        (hierarchical_identifier
                                                                          (simple_identifier)))
                                                                      (expression
                                                                        (primary
                                                                          (function_subroutine_call
                                                                            (subroutine_call
                                                                              (system_tf_call
                                                                                (system_tf_identifier)
                                                                                (list_of_arguments
                                                                                  (expression
                                                                                    (primary
                                                                                      (primary_literal
                                                                                        (integral_number
                                                                                          (decimal_number
                                                                                            (unsigned_number))))))
                                                                                  (expression
                                                                                    (primary
                                                                                      (primary_literal
                                                                                        (integral_number
                                                                                          (decimal_number
                                                                                            (unsigned_number))))))))))))))))
                                                              (statement_or_null
                                                                (statement
                                                                  (statement_item
                                                                    (nonblocking_assignment
                                                                      (variable_lvalue
                                                                        (hierarchical_identifier
                                                                          (simple_identifier)))
                                                                      (expression
                                                                        left: (expression
                                                                          (primary
                                                                            (hierarchical_identifier
                                                                              (simple_identifier))))
                                                                        right: (expression
                                                                          (primary
                                                                            (primary_literal
                                                                              (integral_number
                                                                                (decimal_number
                                                                                  (unsigned_number))))))))))))))))))))))))))))))))))))))))
    (module_item
      (continuous_assign
        (list_of_net_assignments
          (net_assignment
            (net_lvalue
              (simple_identifier))
            (expression
              left: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier))))
              right: (expression
                (primary
                  (mintypmax_expression
                    (expression
                      left: (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier))))
                      right: (expression
                        (primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number)))))))))))))))
    (module_item
      (continuous_assign
        (list_of_net_assignments
          (net_assignment
            (net_lvalue
              (simple_identifier))
            (expression
              left: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier))))
              right: (expression
                (primary
                  (mintypmax_expression
                    (expression
                      left: (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier))))
                      right: (expression
                        (primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number)))))))))))))))
    (one_line_comment)
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_atom_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (always_construct
        (always_keyword)
        (statement
          (statement_item
            (procedural_timing_control_statement
              (event_control
                (clocking_event
                  (event_expression
                    (edge_identifier)
                    (expression
                      (primary
                        (hierarchical_identifier
                          (simple_identifier)))))))
              (statement_or_null
                (statement
                  (statement_item
                    (seq_block
                      (statement_or_null
                        (statement
                          (statement_item
                            (conditional_statement
                              (cond_predicate
                                (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier)))))
                              (statement_or_null
                                (statement
                                  (statement_item
                                    (seq_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (nonblocking_assignment
                                              (variable_lvalue
                                                (hierarchical_identifier
                                                  (simple_identifier)))
                                              (expression
                                                (primary
                                                  (primary_literal
                                                    (integral_number
                                                      (decimal_number
                                                        (unsigned_number))))))))))))))
                              (statement_or_null
                                (statement
                                  (statement_item
                                    (seq_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (conditional_statement
                                              (cond_predicate
                                                (expression
                                                  (primary
                                                    (hierarchical_identifier
                                                      (simple_identifier)))))
                                              (statement_or_null
                                                (statement
                                                  (statement_item
                                                    (seq_block
                                                      (statement_or_null
                                                        (statement
                                                          (statement_item
                                                            (conditional_statement
                                                              (cond_predicate
                                                                (expression
                                                                  left: (expression
                                                                    (primary
                                                                      (hierarchical_identifier
                                                                        (simple_identifier))))
                                                                  right: (expression
                                                                    (primary
                                                                      (primary_literal
                                                                        (integral_number
                                                                          (decimal_number
                                                                            (unsigned_number))))))))
                                                              (statement_or_null
                                                                (statement
                                                                  (statement_item
                                                                    (seq_block
                                                                      (statement_or_null
                                                                        (statement
                                                                          (statement_item
                                                                            (nonblocking_assignment
                                                                              (variable_lvalue
                                                                                (hierarchical_identifier
                                                                                  (simple_identifier)))
                                                                              (expression
                                                                                (primary
                                                                                  (function_subroutine_call
                                                                                    (subroutine_call
                                                                                      (system_tf_call
                                                                                        (system_tf_identifier)
                                                                                        (list_of_arguments
                                                                                          (expression
                                                                                            (primary
                                                                                              (primary_literal
                                                                                                (integral_number
                                                                                                  (decimal_number
                                                                                                    (unsigned_number))))))
                                                                                          (expression
                                                                                            (primary
                                                                                              (primary_literal
                                                                                                (integral_number
                                                                                                  (decimal_number
                                                                                                    (unsigned_number))))))))))))))))))))
                                                              (statement_or_null
                                                                (statement
                                                                  (statement_item
                                                                    (seq_block
                                                                      (statement_or_null
                                                                        (statement
                                                                          (statement_item
                                                                            (nonblocking_assignment
                                                                              (variable_lvalue
                                                                                (hierarchical_identifier
                                                                                  (simple_identifier)))
                                                                              (expression
                                                                                left: (expression
                                                                                  (primary
                                                                                    (hierarchical_identifier
                                                                                      (simple_identifier))))
                                                                                right: (expression
                                                                                  (primary
                                                                                    (primary_literal
                                                                                      (integral_number
                                                                                        (decimal_number
                                                                                          (unsigned_number))))))))))))))))))))))))))))))))))))))))))))
    (module_item
      (continuous_assign
        (list_of_net_assignments
          (net_assignment
            (net_lvalue
              (simple_identifier))
            (expression
              left: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier))))
              right: (expression
                (primary
                  (mintypmax_expression
                    (expression
                      left: (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier))))
                      right: (expression
                        (primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number)))))))))))))))
    (module_item
      (data_declaration
        (data_type_or_implicit
          (data_type
            (integer_atom_type)))
        (list_of_variable_decl_assignments
          (variable_decl_assignment
            name: (simple_identifier)))))
    (module_item
      (always_construct
        (always_keyword)
        (statement
          (statement_item
            (procedural_timing_control_statement
              (event_control
                (clocking_event
                  (event_expression
                    (edge_identifier)
                    (expression
                      (primary
                        (hierarchical_identifier
                          (simple_identifier)))))))
              (statement_or_null
                (statement
                  (statement_item
                    (seq_block
                      (statement_or_null
                        (statement
                          (statement_item
                            (conditional_statement
                              (cond_predicate
                                (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier)))))
                              (statement_or_null
                                (statement
                                  (statement_item
                                    (seq_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (nonblocking_assignment
                                              (variable_lvalue
                                                (hierarchical_identifier
                                                  (simple_identifier)))
                                              (expression
                                                (primary
                                                  (primary_literal
                                                    (integral_number
                                                      (decimal_number
                                                        (unsigned_number))))))))))))))
                              (statement_or_null
                                (statement
                                  (statement_item
                                    (seq_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (conditional_statement
                                              (cond_predicate
                                                (expression
                                                  (primary
                                                    (hierarchical_identifier
                                                      (simple_identifier)))))
                                              (statement_or_null
                                                (statement
                                                  (statement_item
                                                    (seq_block
                                                      (statement_or_null
                                                        (statement
                                                          (statement_item
                                                            (nonblocking_assignment
                                                              (variable_lvalue
                                                                (hierarchical_identifier
                                                                  (simple_identifier)))
                                                              (expression
                                                                left: (expression
                                                                  (primary
                                                                    (hierarchical_identifier
                                                                      (simple_identifier))))
                                                                right: (expression
                                                                  (primary
                                                                    (primary_literal
                                                                      (integral_number
                                                                        (decimal_number
                                                                          (unsigned_number)))))))))))
                                                      (statement_or_null
                                                        (statement
                                                          (statement_item
                                                            (subroutine_call_statement
                                                              (subroutine_call
                                                                (system_tf_call
                                                                  (system_tf_identifier)
                                                                  (list_of_arguments
                                                                    (expression
                                                                      (primary
                                                                        (primary_literal
                                                                          (string_literal
                                                                            (quoted_string
                                                                              (quoted_string_item))))))
                                                                    (expression
                                                                      (primary
                                                                        (hierarchical_identifier
                                                                          (simple_identifier)))))))))))
                                                      (statement_or_null
                                                        (statement
                                                          (statement_item
                                                            (simple_immediate_assert_statement
                                                              (expression
                                                                left: (expression
                                                                  (primary
                                                                    (hierarchical_identifier
                                                                      (simple_identifier))))
                                                                right: (expression
                                                                  (primary
                                                                    (hierarchical_identifier
                                                                      (simple_identifier)))))
                                                              (action_block
                                                                (statement_or_null
                                                                  (statement
                                                                    (statement_item
                                                                      (subroutine_call_statement
                                                                        (severity_system_task
                                                                          (finish_number)
                                                                          (list_of_arguments
                                                                            (expression
                                                                              (primary
                                                                                (primary_literal
                                                                                  (string_literal
                                                                                    (quoted_string
                                                                                      (quoted_string_item))))))))))))))))))))))))))))))))))))))))))
    (module_item
      (initial_construct
        (statement_or_null
          (statement
            (statement_item
              (seq_block
                (statement_or_null
                  (statement
                    (statement_item
                      (wait_statement
                        (expression
                          left: (expression
                            (primary
                              (mintypmax_expression
                                (expression
                                  left: (expression
                                    (primary
                                      (hierarchical_identifier
                                        (simple_identifier))))
                                  right: (expression
                                    (primary
                                      (hierarchical_identifier
                                        (simple_identifier))))))))
                          right: (expression
                            (primary
                              (mintypmax_expression
                                (expression
                                  left: (expression
                                    (primary
                                      (hierarchical_identifier
                                        (simple_identifier))))
                                  right: (expression
                                    (primary
                                      (hierarchical_identifier
                                        (simple_identifier)))))))))
                        (statement_or_null)))))
                (statement_or_null
                  (statement
                    (statement_item
                      (procedural_timing_control_statement
                        (delay_control
                          (delay_value
                            (unsigned_number)))
                        (statement_or_null)))))
                (statement_or_null
                  (statement
                    (statement_item
                      (simple_immediate_assert_statement
                        (expression
                          (primary
                            (hierarchical_identifier
                              (simple_identifier))))
                        (action_block
                          (statement_or_null
                            (statement
                              (statement_item
                                (subroutine_call_statement
                                  (severity_system_task
                                    (finish_number)
                                    (list_of_arguments
                                      (expression
                                        (primary
                                          (primary_literal
                                            (string_literal
                                              (quoted_string
                                                (quoted_string_item)))))))))))))))))
                (statement_or_null
                  (statement
                    (statement_item
                      (subroutine_call_statement
                        (simulation_control_task)))))))))))))
