============================================
basejump_stl/testing/bsg_dataflow/bsg_fifo_1r1w_small_hardened_random/bsg_fifo_1r1w_small_hardened_cov
============================================

//
// Paul Gao   08/2021
//
// This module defines functional coverages of module bsg_fifo_1r1w_small_hardened
//
//

`include "bsg_defines.sv"

module bsg_fifo_1r1w_small_hardened_cov

 #(parameter els_p = "inv"
  ,localparam ptr_width_lp = `BSG_SAFE_CLOG2(els_p)
  )

  (input clk_i
  ,input reset_i

  // interface signals
  ,input v_i
  ,input yumi_i

  // internal registers
  ,input [ptr_width_lp-1:0] rptr_r
  ,input [ptr_width_lp-1:0] wptr_r
  ,input full  // registered in sub-module bsg_fifo_tracker
  ,input empty // registered in sub-module bsg_fifo_tracker
  ,input read_write_same_addr_r
  );

  // reset
  covergroup cg_reset @(negedge clk_i);
    coverpoint reset_i;
  endgroup

  // Partitioning covergroup into smaller ones
  // empty
  covergroup cg_empty @ (negedge clk_i iff ~reset_i & empty & ~full);

    cp_v: coverpoint v_i;
    // cannot deque when empty
    cp_yumi: coverpoint yumi_i {illegal_bins ig = {1};}
    cp_rptr: coverpoint rptr_r;
    cp_wptr: coverpoint wptr_r;
    // If read write same address happened in previous cycle, fifo should
    // have one element in current cycle, which contradicts with the
    // condition that fifo is empty.
    cp_rwsa: coverpoint read_write_same_addr_r {illegal_bins ig = {1};}

    cross_all: cross cp_v, cp_yumi, cp_rptr, cp_wptr, cp_rwsa {
      // by definition, fifo empty means r/w pointers are the same
      illegal_bins ig0 = cross_all with (cp_rptr != cp_wptr);
    }

  endgroup

  // full
  covergroup cg_full @ (negedge clk_i iff ~reset_i & ~empty & full);

    cp_v: coverpoint v_i;
    cp_yumi: coverpoint yumi_i;
    cp_rptr: coverpoint rptr_r;
    cp_wptr: coverpoint wptr_r;
    // If read write same address happened in previous cycle, fifo should
    // only have one element in current cycle, which contradicts with the
    // condition that fifo is full.
    cp_rwsa: coverpoint read_write_same_addr_r {illegal_bins ig = {1};}

    cross_all: cross cp_v, cp_yumi, cp_rptr, cp_wptr, cp_rwsa {
      // by definition, fifo full means r/w pointers are the same
      illegal_bins ig0 = cross_all with (cp_rptr != cp_wptr);
    }

  endgroup

  // fifo normal
  covergroup cg_normal @ (negedge clk_i iff ~reset_i & ~empty & ~full);

    cp_v: coverpoint v_i;
    cp_yumi: coverpoint yumi_i;
    cp_rptr: coverpoint rptr_r;
    cp_wptr: coverpoint wptr_r;
    cp_rwsa: coverpoint read_write_same_addr_r;

    cross_all: cross cp_v, cp_yumi, cp_rptr, cp_wptr, cp_rwsa {
      // by definition, r/w pointers are different when fifo is non-empty & non-full
      illegal_bins ig0 = cross_all with (cp_rptr == cp_wptr);
      // If read write same address happened in previous cycle, fifo should
      // only have one element in current cycle. Write-pointer should be
      // read-pointer plus one (or wrapped-around).
      illegal_bins ig1 = cross_all with (
        (cp_rwsa == 1)
        && (cp_wptr - cp_rptr != 1)
        && (cp_wptr - cp_rptr != 1-els_p)
        );
    }

  endgroup

  // create cover groups
  cg_reset cov_reset = new;
  cg_empty cov_empty = new;
  cg_full cov_full = new;
  cg_normal cov_normal = new;

  // print coverages when simulation is done
  final
  begin
    $display("");
    $display("Instance: %m");
    $display("---------------------- Functional Coverage Results ----------------------");
    $display("Reset       functional coverage is %f%%", cov_reset.get_coverage());
    $display("Fifo empty  functional coverage is %f%%", cov_empty.cross_all.get_coverage());
    $display("Fifo full   functional coverage is %f%%", cov_full.cross_all.get_coverage());
    $display("Fifo normal functional coverage is %f%%", cov_normal.cross_all.get_coverage());
    $display("-------------------------------------------------------------------------");
    $display("");
  end

endmodule

----

(source_file
  (one_line_comment)
  (one_line_comment)
  (one_line_comment)
  (one_line_comment)
  (one_line_comment)
  (one_line_comment)
  (include_compiler_directive
    (quoted_string
      (quoted_string_item)))
  (module_declaration
    (module_ansi_header
      (module_keyword)
      name: (simple_identifier)
      (parameter_port_list
        (parameter_port_declaration
          (parameter_declaration
            (list_of_param_assignments
              (param_assignment
                (simple_identifier)
                (constant_param_expression
                  (constant_mintypmax_expression
                    (constant_expression
                      (constant_primary
                        (primary_literal
                          (string_literal
                            (quoted_string
                              (quoted_string_item))))))))))))
        (parameter_port_declaration
          (local_parameter_declaration
            (list_of_param_assignments
              (param_assignment
                (simple_identifier)
                (constant_param_expression
                  (constant_mintypmax_expression
                    (constant_expression
                      (text_macro_usage
                        (simple_identifier)
                        (list_of_actual_arguments
                          (actual_argument
                            (param_expression
                              (mintypmax_expression
                                (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier)))))))))))))))))
      (list_of_port_declarations
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (one_line_comment)
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (one_line_comment)
        (ansi_port_declaration
          (net_port_header
            (port_direction)
            (net_port_type
              (data_type_or_implicit
                (implicit_data_type
                  (packed_dimension
                    (constant_range
                      (constant_expression
                        left: (constant_expression
                          (constant_primary
                            (simple_identifier)))
                        right: (constant_expression
                          (constant_primary
                            (primary_literal
                              (integral_number
                                (decimal_number
                                  (unsigned_number)))))))
                      (constant_expression
                        (constant_primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number))))))))))))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction)
            (net_port_type
              (data_type_or_implicit
                (implicit_data_type
                  (packed_dimension
                    (constant_range
                      (constant_expression
                        left: (constant_expression
                          (constant_primary
                            (simple_identifier)))
                        right: (constant_expression
                          (constant_primary
                            (primary_literal
                              (integral_number
                                (decimal_number
                                  (unsigned_number)))))))
                      (constant_expression
                        (constant_primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number))))))))))))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (one_line_comment)
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (one_line_comment)
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))))
    (one_line_comment)
    (covergroup_declaration
      name: (simple_identifier)
      (coverage_event
        (clocking_event
          (event_expression
            (edge_identifier)
            (expression
              (primary
                (hierarchical_identifier
                  (simple_identifier)))))))
      (coverage_spec_or_option
        (cover_point
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty))))
    (one_line_comment)
    (one_line_comment)
    (covergroup_declaration
      name: (simple_identifier)
      (coverage_event
        (clocking_event
          (event_expression
            (edge_identifier)
            (expression
              (primary
                (hierarchical_identifier
                  (simple_identifier))))
            (expression
              left: (expression
                left: (expression
                  operator: (unary_operator)
                  argument: (primary
                    (hierarchical_identifier
                      (simple_identifier))))
                right: (expression
                  (primary
                    (hierarchical_identifier
                      (simple_identifier)))))
              right: (expression
                operator: (unary_operator)
                argument: (primary
                  (hierarchical_identifier
                    (simple_identifier))))))))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (one_line_comment)
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty
            (bins_or_options
              (bins_keyword)
              name: (simple_identifier)
              (covergroup_range_list
                (covergroup_value_range
                  (expression
                    (primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number))))))))))))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (one_line_comment)
      (one_line_comment)
      (one_line_comment)
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty
            (bins_or_options
              (bins_keyword)
              name: (simple_identifier)
              (covergroup_range_list
                (covergroup_value_range
                  (expression
                    (primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number))))))))))))
      (coverage_spec_or_option
        (cover_cross
          name: (simple_identifier)
          (list_of_cross_items
            (simple_identifier)
            (simple_identifier)
            (simple_identifier)
            (simple_identifier)
            (simple_identifier))
          (cross_body
            (one_line_comment)
            (cross_body_item
              (bins_selection_or_option
                (bins_selection
                  (bins_keyword)
                  (simple_identifier)
                  (select_expression
                    (select_expression
                      (simple_identifier))
                    (expression
                      left: (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier))))
                      right: (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))))))))))
    (one_line_comment)
    (covergroup_declaration
      name: (simple_identifier)
      (coverage_event
        (clocking_event
          (event_expression
            (edge_identifier)
            (expression
              (primary
                (hierarchical_identifier
                  (simple_identifier))))
            (expression
              left: (expression
                left: (expression
                  operator: (unary_operator)
                  argument: (primary
                    (hierarchical_identifier
                      (simple_identifier))))
                right: (expression
                  operator: (unary_operator)
                  argument: (primary
                    (hierarchical_identifier
                      (simple_identifier)))))
              right: (expression
                (primary
                  (hierarchical_identifier
                    (simple_identifier))))))))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (one_line_comment)
      (one_line_comment)
      (one_line_comment)
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty
            (bins_or_options
              (bins_keyword)
              name: (simple_identifier)
              (covergroup_range_list
                (covergroup_value_range
                  (expression
                    (primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number))))))))))))
      (coverage_spec_or_option
        (cover_cross
          name: (simple_identifier)
          (list_of_cross_items
            (simple_identifier)
            (simple_identifier)
            (simple_identifier)
            (simple_identifier)
            (simple_identifier))
          (cross_body
            (one_line_comment)
            (cross_body_item
              (bins_selection_or_option
                (bins_selection
                  (bins_keyword)
                  (simple_identifier)
                  (select_expression
                    (select_expression
                      (simple_identifier))
                    (expression
                      left: (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier))))
                      right: (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))))))))))
    (one_line_comment)
    (covergroup_declaration
      name: (simple_identifier)
      (coverage_event
        (clocking_event
          (event_expression
            (edge_identifier)
            (expression
              (primary
                (hierarchical_identifier
                  (simple_identifier))))
            (expression
              left: (expression
                left: (expression
                  operator: (unary_operator)
                  argument: (primary
                    (hierarchical_identifier
                      (simple_identifier))))
                right: (expression
                  operator: (unary_operator)
                  argument: (primary
                    (hierarchical_identifier
                      (simple_identifier)))))
              right: (expression
                operator: (unary_operator)
                argument: (primary
                  (hierarchical_identifier
                    (simple_identifier))))))))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (coverage_spec_or_option
        (cover_point
          name: (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier))))
          (bins_or_empty)))
      (coverage_spec_or_option
        (cover_cross
          name: (simple_identifier)
          (list_of_cross_items
            (simple_identifier)
            (simple_identifier)
            (simple_identifier)
            (simple_identifier)
            (simple_identifier))
          (cross_body
            (one_line_comment)
            (cross_body_item
              (bins_selection_or_option
                (bins_selection
                  (bins_keyword)
                  (simple_identifier)
                  (select_expression
                    (select_expression
                      (simple_identifier))
                    (expression
                      left: (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier))))
                      right: (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))))))
            (one_line_comment)
            (one_line_comment)
            (one_line_comment)
            (cross_body_item
              (bins_selection_or_option
                (bins_selection
                  (bins_keyword)
                  (simple_identifier)
                  (select_expression
                    (select_expression
                      (simple_identifier))
                    (expression
                      left: (expression
                        left: (expression
                          (primary
                            (mintypmax_expression
                              (expression
                                left: (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier))))
                                right: (expression
                                  (primary
                                    (primary_literal
                                      (integral_number
                                        (decimal_number
                                          (unsigned_number))))))))))
                        right: (expression
                          (primary
                            (mintypmax_expression
                              (expression
                                left: (expression
                                  left: (expression
                                    (primary
                                      (hierarchical_identifier
                                        (simple_identifier))))
                                  right: (expression
                                    (primary
                                      (hierarchical_identifier
                                        (simple_identifier)))))
                                right: (expression
                                  (primary
                                    (primary_literal
                                      (integral_number
                                        (decimal_number
                                          (unsigned_number)))))))))))
                      right: (expression
                        (primary
                          (mintypmax_expression
                            (expression
                              left: (expression
                                left: (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier))))
                                right: (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier)))))
                              right: (expression
                                left: (expression
                                  (primary
                                    (primary_literal
                                      (integral_number
                                        (decimal_number
                                          (unsigned_number))))))
                                right: (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier))))))))))))))))))
    (one_line_comment)
    (data_declaration
      (data_type_or_implicit
        (data_type
          (simple_identifier)))
      (list_of_variable_decl_assignments
        (variable_decl_assignment
          name: (simple_identifier)
          (class_new))))
    (data_declaration
      (data_type_or_implicit
        (data_type
          (simple_identifier)))
      (list_of_variable_decl_assignments
        (variable_decl_assignment
          name: (simple_identifier)
          (class_new))))
    (data_declaration
      (data_type_or_implicit
        (data_type
          (simple_identifier)))
      (list_of_variable_decl_assignments
        (variable_decl_assignment
          name: (simple_identifier)
          (class_new))))
    (data_declaration
      (data_type_or_implicit
        (data_type
          (simple_identifier)))
      (list_of_variable_decl_assignments
        (variable_decl_assignment
          name: (simple_identifier)
          (class_new))))
    (one_line_comment)
    (final_construct
      (function_statement
        (statement
          (statement_item
            (seq_block
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string))))))))))))
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string
                                      (quoted_string_item)))))))))))))
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string
                                      (quoted_string_item)))))))))))))
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string
                                      (quoted_string_item))))))
                            (expression
                              (primary
                                (function_subroutine_call
                                  (subroutine_call
                                    (tf_call
                                      (hierarchical_identifier
                                        (simple_identifier)
                                        (simple_identifier))))))))))))))
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string
                                      (quoted_string_item))))))
                            (expression
                              (primary
                                (function_subroutine_call
                                  (subroutine_call
                                    (tf_call
                                      (hierarchical_identifier
                                        (simple_identifier)
                                        (simple_identifier)
                                        (simple_identifier))))))))))))))
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string
                                      (quoted_string_item))))))
                            (expression
                              (primary
                                (function_subroutine_call
                                  (subroutine_call
                                    (tf_call
                                      (hierarchical_identifier
                                        (simple_identifier)
                                        (simple_identifier)
                                        (simple_identifier))))))))))))))
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string
                                      (quoted_string_item))))))
                            (expression
                              (primary
                                (function_subroutine_call
                                  (subroutine_call
                                    (tf_call
                                      (hierarchical_identifier
                                        (simple_identifier)
                                        (simple_identifier)
                                        (simple_identifier))))))))))))))
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string
                                      (quoted_string_item)))))))))))))
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string)))))))))))))))))))
