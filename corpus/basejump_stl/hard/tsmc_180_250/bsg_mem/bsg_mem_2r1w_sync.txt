============================================
basejump_stl/hard/tsmc_180_250/bsg_mem/bsg_mem_2r1w_sync
============================================

//
// 2 read-port, 1 write-port ram
//
// reads are synchronous
//
//

module bsg_mem_2r1w_sync #(parameter `BSG_INV_PARAM(width_p)
                           , parameter `BSG_INV_PARAM(els_p)
                           , parameter read_write_same_addr_p=0
                           , parameter addr_width_lp=`BSG_SAFE_CLOG2(els_p)
                           , parameter harden_p=0
                           )
   (input   clk_i
    , input reset_i

    , input                     w_v_i
    , input [addr_width_lp-1:0] w_addr_i
    , input [width_p-1:0]       w_data_i

    // currently unused
    , input                      r0_v_i
    , input [addr_width_lp-1:0]  r0_addr_i
    , output logic [width_p-1:0] r0_data_o

    , input                      r1_v_i
    , input [addr_width_lp-1:0]  r1_addr_i
    , output logic [width_p-1:0] r1_data_o
    );

   wire                   unused = reset_i;

   if ((width_p == 32) && (els_p == 32))
     begin: macro
`ifndef BSG_HIDE_FROM_SYNTHESIS
        initial
          begin
             assert(read_write_same_addr_p==0)
               else
                 begin
                    $error("%L: this configuration does not permit simultaneous read and writes! (%m)");
                    $finish();
                 end
          end
`endif

        // use two 1R1W rams to create
        tsmc180_2rf_lg5_w32_m1_all mem0
          (
           // read port
           .CLKA (clk_i)
           ,.AA  (r0_addr_i)
           ,.CENA(~r0_v_i)

           // output
           ,.QA  (r0_data_o)

           // write port
           ,.CLKB(clk_i)
           ,.AB  (w_addr_i)
           ,.DB  (w_data_i)
           ,.CENB(~w_v_i)
           );

        tsmc180_2rf_lg5_w32_m1_all mem1
          (
           // read port
           .CLKA (clk_i)
           ,.AA  (r1_addr_i)
           ,.CENA(~r1_v_i)

           // output
           ,.QA  (r1_data_o)

           // write port
           ,.CLKB(clk_i)
           ,.AB  (w_addr_i)
           ,.DB  (w_data_i)
           ,.CENB(~w_v_i)
           );

     end // block: macro
   else
     begin: notmacro

	bsg_mem_2r1w_sync_synth
	  #(.width_p(width_p)
	    ,.els_p(els_p)
	    ,.read_write_same_addr_p(read_write_same_addr_p)
	    ,.harden_p(harden_p)
	    ) synth
	    (.*);
     end


`ifndef BSG_HIDE_FROM_SYNTHESIS

   always_ff @(posedge clk_i)
     if (w_v_i)
       begin
          assert (w_addr_i < els_p)
            else $error("Invalid address %x to %m of size %x\n", w_addr_i, els_p);

          assert (~(r0_addr_i == w_addr_i && w_v_i && r0_v_i && !read_write_same_addr_p))
            else $error("%m: port 0 Attempt to read and write same address");

          assert (~(r1_addr_i == w_addr_i && w_v_i && r1_v_i && !read_write_same_addr_p))
            else $error("%m: port 1 Attempt to read and write same address");
       end

   initial
     begin
        $display("## %L: instantiating width_p=%d, els_p=%d, read_write_same_addr_p=%d, harden_p=%d (%m)"
		 ,width_p,els_p,read_write_same_addr_p,harden_p);
     end

`endif

   

endmodule

`BSG_ABSTRACT_MODULE(bsg_mem_2r1w_sync)

----

(source_file
  (one_line_comment)
  (one_line_comment)
  (one_line_comment)
  (one_line_comment)
  (one_line_comment)
  (one_line_comment)
  (module_declaration
    (module_ansi_header
      (module_keyword)
      name: (simple_identifier)
      (parameter_port_list
        (parameter_port_declaration
          (parameter_declaration
            (list_of_param_assignments
              (param_assignment
                (text_macro_usage
                  (simple_identifier)
                  (list_of_actual_arguments
                    (actual_argument
                      (param_expression
                        (mintypmax_expression
                          (expression
                            (primary
                              (hierarchical_identifier
                                (simple_identifier)))))))))))))
        (parameter_port_declaration
          (parameter_declaration
            (list_of_param_assignments
              (param_assignment
                (text_macro_usage
                  (simple_identifier)
                  (list_of_actual_arguments
                    (actual_argument
                      (param_expression
                        (mintypmax_expression
                          (expression
                            (primary
                              (hierarchical_identifier
                                (simple_identifier)))))))))))))
        (parameter_port_declaration
          (parameter_declaration
            (list_of_param_assignments
              (param_assignment
                (simple_identifier)
                (constant_param_expression
                  (constant_mintypmax_expression
                    (constant_expression
                      (constant_primary
                        (primary_literal
                          (integral_number
                            (decimal_number
                              (unsigned_number))))))))))))
        (parameter_port_declaration
          (parameter_declaration
            (list_of_param_assignments
              (param_assignment
                (simple_identifier)
                (constant_param_expression
                  (constant_mintypmax_expression
                    (constant_expression
                      (text_macro_usage
                        (simple_identifier)
                        (list_of_actual_arguments
                          (actual_argument
                            (param_expression
                              (mintypmax_expression
                                (expression
                                  (primary
                                    (hierarchical_identifier
                                      (simple_identifier))))))))))))))))
        (parameter_port_declaration
          (parameter_declaration
            (list_of_param_assignments
              (param_assignment
                (simple_identifier)
                (constant_param_expression
                  (constant_mintypmax_expression
                    (constant_expression
                      (constant_primary
                        (primary_literal
                          (integral_number
                            (decimal_number
                              (unsigned_number)))))))))))))
      (list_of_port_declarations
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction)
            (net_port_type
              (data_type_or_implicit
                (implicit_data_type
                  (packed_dimension
                    (constant_range
                      (constant_expression
                        left: (constant_expression
                          (constant_primary
                            (simple_identifier)))
                        right: (constant_expression
                          (constant_primary
                            (primary_literal
                              (integral_number
                                (decimal_number
                                  (unsigned_number)))))))
                      (constant_expression
                        (constant_primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number))))))))))))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction)
            (net_port_type
              (data_type_or_implicit
                (implicit_data_type
                  (packed_dimension
                    (constant_range
                      (constant_expression
                        left: (constant_expression
                          (constant_primary
                            (simple_identifier)))
                        right: (constant_expression
                          (constant_primary
                            (primary_literal
                              (integral_number
                                (decimal_number
                                  (unsigned_number)))))))
                      (constant_expression
                        (constant_primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number))))))))))))
          port_name: (simple_identifier))
        (one_line_comment)
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction)
            (net_port_type
              (data_type_or_implicit
                (implicit_data_type
                  (packed_dimension
                    (constant_range
                      (constant_expression
                        left: (constant_expression
                          (constant_primary
                            (simple_identifier)))
                        right: (constant_expression
                          (constant_primary
                            (primary_literal
                              (integral_number
                                (decimal_number
                                  (unsigned_number)))))))
                      (constant_expression
                        (constant_primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number))))))))))))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (variable_port_header
            (port_direction)
            (variable_port_type
              (data_type
                (integer_vector_type)
                (packed_dimension
                  (constant_range
                    (constant_expression
                      left: (constant_expression
                        (constant_primary
                          (simple_identifier)))
                      right: (constant_expression
                        (constant_primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number)))))))
                    (constant_expression
                      (constant_primary
                        (primary_literal
                          (integral_number
                            (decimal_number
                              (unsigned_number)))))))))))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (net_port_header
            (port_direction)
            (net_port_type
              (data_type_or_implicit
                (implicit_data_type
                  (packed_dimension
                    (constant_range
                      (constant_expression
                        left: (constant_expression
                          (constant_primary
                            (simple_identifier)))
                        right: (constant_expression
                          (constant_primary
                            (primary_literal
                              (integral_number
                                (decimal_number
                                  (unsigned_number)))))))
                      (constant_expression
                        (constant_primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number))))))))))))
          port_name: (simple_identifier))
        (ansi_port_declaration
          (variable_port_header
            (port_direction)
            (variable_port_type
              (data_type
                (integer_vector_type)
                (packed_dimension
                  (constant_range
                    (constant_expression
                      left: (constant_expression
                        (constant_primary
                          (simple_identifier)))
                      right: (constant_expression
                        (constant_primary
                          (primary_literal
                            (integral_number
                              (decimal_number
                                (unsigned_number)))))))
                    (constant_expression
                      (constant_primary
                        (primary_literal
                          (integral_number
                            (decimal_number
                              (unsigned_number)))))))))))
          port_name: (simple_identifier))))
    (net_declaration
      (net_type)
      (list_of_net_decl_assignments
        (net_decl_assignment
          (simple_identifier)
          (expression
            (primary
              (hierarchical_identifier
                (simple_identifier)))))))
    (conditional_generate_construct
      (if_generate_construct
        (constant_expression
          left: (constant_expression
            (constant_primary
              (constant_mintypmax_expression
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number))))))))))
          right: (constant_expression
            (constant_primary
              (constant_mintypmax_expression
                (constant_expression
                  left: (constant_expression
                    (constant_primary
                      (simple_identifier)))
                  right: (constant_expression
                    (constant_primary
                      (primary_literal
                        (integral_number
                          (decimal_number
                            (unsigned_number)))))))))))
        (generate_block
          name: (simple_identifier)
          (conditional_compilation_directive
            (ifdef_condition
              (simple_identifier)))
          (initial_construct
            (statement_or_null
              (statement
                (statement_item
                  (seq_block
                    (statement_or_null
                      (statement
                        (statement_item
                          (simple_immediate_assert_statement
                            (expression
                              left: (expression
                                (primary
                                  (hierarchical_identifier
                                    (simple_identifier))))
                              right: (expression
                                (primary
                                  (primary_literal
                                    (integral_number
                                      (decimal_number
                                        (unsigned_number)))))))
                            (action_block
                              (statement_or_null
                                (statement
                                  (statement_item
                                    (seq_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (subroutine_call_statement
                                              (severity_system_task
                                                (list_of_arguments
                                                  (expression
                                                    (primary
                                                      (primary_literal
                                                        (string_literal
                                                          (quoted_string
                                                            (quoted_string_item))))))))))))
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (subroutine_call_statement
                                              (simulation_control_task)))))))))))))))))))
          (conditional_compilation_directive)
          (one_line_comment)
          (module_instantiation
            instance_type: (simple_identifier)
            (hierarchical_instance
              (name_of_instance
                instance_name: (simple_identifier))
              (one_line_comment)
              (list_of_port_connections
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    operator: (unary_operator)
                    argument: (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (one_line_comment)
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (one_line_comment)
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    operator: (unary_operator)
                    argument: (primary
                      (hierarchical_identifier
                        (simple_identifier))))))))
          (module_instantiation
            instance_type: (simple_identifier)
            (hierarchical_instance
              (name_of_instance
                instance_name: (simple_identifier))
              (one_line_comment)
              (list_of_port_connections
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    operator: (unary_operator)
                    argument: (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (one_line_comment)
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (one_line_comment)
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))
                (named_port_connection
                  port_name: (simple_identifier)
                  connection: (expression
                    operator: (unary_operator)
                    argument: (primary
                      (hierarchical_identifier
                        (simple_identifier)))))))))
        (one_line_comment)
        (generate_block
          name: (simple_identifier)
          (module_instantiation
            instance_type: (simple_identifier)
            (parameter_value_assignment
              (list_of_parameter_value_assignments
                (named_parameter_assignment
                  (simple_identifier)
                  (param_expression
                    (mintypmax_expression
                      (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))))
                (named_parameter_assignment
                  (simple_identifier)
                  (param_expression
                    (mintypmax_expression
                      (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))))
                (named_parameter_assignment
                  (simple_identifier)
                  (param_expression
                    (mintypmax_expression
                      (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))))
                (named_parameter_assignment
                  (simple_identifier)
                  (param_expression
                    (mintypmax_expression
                      (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))))))
            (hierarchical_instance
              (name_of_instance
                instance_name: (simple_identifier))
              (list_of_port_connections
                (named_port_connection)))))))
    (conditional_compilation_directive
      (ifdef_condition
        (simple_identifier)))
    (always_construct
      (always_keyword)
      (statement
        (statement_item
          (procedural_timing_control_statement
            (event_control
              (clocking_event
                (event_expression
                  (edge_identifier)
                  (expression
                    (primary
                      (hierarchical_identifier
                        (simple_identifier)))))))
            (statement_or_null
              (statement
                (statement_item
                  (conditional_statement
                    (cond_predicate
                      (expression
                        (primary
                          (hierarchical_identifier
                            (simple_identifier)))))
                    (statement_or_null
                      (statement
                        (statement_item
                          (seq_block
                            (statement_or_null
                              (statement
                                (statement_item
                                  (simple_immediate_assert_statement
                                    (expression
                                      left: (expression
                                        (primary
                                          (hierarchical_identifier
                                            (simple_identifier))))
                                      right: (expression
                                        (primary
                                          (hierarchical_identifier
                                            (simple_identifier)))))
                                    (action_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (subroutine_call_statement
                                              (severity_system_task
                                                (list_of_arguments
                                                  (expression
                                                    (primary
                                                      (primary_literal
                                                        (string_literal
                                                          (quoted_string
                                                            (quoted_string_item)
                                                            (string_escape_seq))))))
                                                  (expression
                                                    (primary
                                                      (hierarchical_identifier
                                                        (simple_identifier))))
                                                  (expression
                                                    (primary
                                                      (hierarchical_identifier
                                                        (simple_identifier)))))))))))))))
                            (statement_or_null
                              (statement
                                (statement_item
                                  (simple_immediate_assert_statement
                                    (expression
                                      operator: (unary_operator)
                                      argument: (primary
                                        (mintypmax_expression
                                          (expression
                                            left: (expression
                                              left: (expression
                                                left: (expression
                                                  left: (expression
                                                    (primary
                                                      (hierarchical_identifier
                                                        (simple_identifier))))
                                                  right: (expression
                                                    (primary
                                                      (hierarchical_identifier
                                                        (simple_identifier)))))
                                                right: (expression
                                                  (primary
                                                    (hierarchical_identifier
                                                      (simple_identifier)))))
                                              right: (expression
                                                (primary
                                                  (hierarchical_identifier
                                                    (simple_identifier)))))
                                            right: (expression
                                              operator: (unary_operator)
                                              argument: (primary
                                                (hierarchical_identifier
                                                  (simple_identifier))))))))
                                    (action_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (subroutine_call_statement
                                              (severity_system_task
                                                (list_of_arguments
                                                  (expression
                                                    (primary
                                                      (primary_literal
                                                        (string_literal
                                                          (quoted_string
                                                            (quoted_string_item)))))))))))))))))
                            (statement_or_null
                              (statement
                                (statement_item
                                  (simple_immediate_assert_statement
                                    (expression
                                      operator: (unary_operator)
                                      argument: (primary
                                        (mintypmax_expression
                                          (expression
                                            left: (expression
                                              left: (expression
                                                left: (expression
                                                  left: (expression
                                                    (primary
                                                      (hierarchical_identifier
                                                        (simple_identifier))))
                                                  right: (expression
                                                    (primary
                                                      (hierarchical_identifier
                                                        (simple_identifier)))))
                                                right: (expression
                                                  (primary
                                                    (hierarchical_identifier
                                                      (simple_identifier)))))
                                              right: (expression
                                                (primary
                                                  (hierarchical_identifier
                                                    (simple_identifier)))))
                                            right: (expression
                                              operator: (unary_operator)
                                              argument: (primary
                                                (hierarchical_identifier
                                                  (simple_identifier))))))))
                                    (action_block
                                      (statement_or_null
                                        (statement
                                          (statement_item
                                            (subroutine_call_statement
                                              (severity_system_task
                                                (list_of_arguments
                                                  (expression
                                                    (primary
                                                      (primary_literal
                                                        (string_literal
                                                          (quoted_string
                                                            (quoted_string_item)))))))))))))))))))))))))))))
    (initial_construct
      (statement_or_null
        (statement
          (statement_item
            (seq_block
              (statement_or_null
                (statement
                  (statement_item
                    (subroutine_call_statement
                      (subroutine_call
                        (system_tf_call
                          (system_tf_identifier)
                          (list_of_arguments
                            (expression
                              (primary
                                (primary_literal
                                  (string_literal
                                    (quoted_string
                                      (quoted_string_item))))))
                            (expression
                              (primary
                                (hierarchical_identifier
                                  (simple_identifier))))
                            (expression
                              (primary
                                (hierarchical_identifier
                                  (simple_identifier))))
                            (expression
                              (primary
                                (hierarchical_identifier
                                  (simple_identifier))))
                            (expression
                              (primary
                                (hierarchical_identifier
                                  (simple_identifier))))))))))))))))
    (conditional_compilation_directive))
  (text_macro_usage
    (simple_identifier)
    (list_of_actual_arguments
      (actual_argument
        (param_expression
          (mintypmax_expression
            (expression
              (primary
                (hierarchical_identifier
                  (simple_identifier))))))))))
